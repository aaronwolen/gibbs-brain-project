# Correlations between microRNAs and mRNA predicted targets

```{r knitr-setup, include=FALSE}
report.title <- "crossdata-correlations-micro-exp"
fig.path <- file.path("figures", report.title)
fig.prefix <- "cors-micro-exp-"

dir.create(fig.path, showWarnings = FALSE)

opts_chunk$set(fig.path = file.path(fig.path, fig.prefix),
  cache.path = paste(".cache-", report.title, "/", sep = ""),
  echo=FALSE, results = 'hide',
  cache=FALSE, fig.width=5, fig.height=4, dpi=150)
```

```{r load-libraries, cache=FALSE, message=FALSE}
library(Biobase)
library(grid)
library(plyr)
library(ggplot2)
 
source("functions/knit_template.r")
source("functions/print_xtable.r")
source("functions/save-figures.r")
```

```{r load-data, cache=FALSE, message=FALSE}
load("data/crossdata-correlations-micro-exp/eset-exp-adjusted.rda")
load("data/crossdata-correlations-micro-exp/eset-micro-adjusted.rda")
```

Explore and visualize correlation results generated between the microRNA and mRNA expression data based on various target prediction resources.

* script: [`crossdata-correlations-micro-exp-analysis.r`](https://github.com/aaronwolen/gibbs-brain-project/blob/master/crossdata-correlations-micro-exp-analysis.r)


## Methods
The analysis was performed independently for each tissue. Subsets of the expression and methylation eSet objects were created to include only samples from individuals present in both datasets. mRNA and microRNA expression levels were adjusted for age and sample tissue bank by fitting a linear model with these variables and using the residuals in the correlation analysis.

microRNA probes were included in this analysis only if the mature microRNA target symbols were present in the mirbase database provided by the `RmiR.hsa` package. This database was used to putative targets for each microRNA. Correlations were calculated between each microRNA and all putative targets listed in the mirbase database, overlap was determined using Entrez IDs. 

Correlations were calculated using the standard `cor` function and with use set to `"pairwise.complete"`. P-values were obtained using the `WGCNA` package's `corPvalueStudent` function and multiple testing corrections were performed using the Benjamini & Hochberg method for generating q-values.

### Outlier exclusion
This analysis was re-run after removing samples from the microRNA and mRNA expression data that showed extreme deviations from a median-generated reference sample. Without these outliers, there were ~2,000 fewer correlations in the cerebellum with a q-value < 0.05. However, at the same level of significance, there were ~2,000 more in pons, ~3,000 more in temporal cortex and ~4,000 more in the frontal cortex. The original results can be obtained from commit [468768aa9d](https://github.com/aaronwolen/gibbs-brain-project/commit/468768aa9d8db8608885b6bcd3522a8814c3c788#results/crossdata-micro-exp-correlations.rda). 


## Results

```{r generate-report, include=FALSE}
report <- knit_template("templates/crossdata-correlations-micro-exp-report.tpl",
  labels = "mirbase", variable = "mirdb")
```

```{r print-report, include=TRUE, results='asis'}
cat(report, "\n")
```

